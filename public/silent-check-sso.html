<!DOCTYPE html>
<html>
  <head>
    <title>Keycloak Silent Check SSO</title>
  </head>
  <body>
    <!--
      이 페이지는 Keycloak의 'check-sso' 옵션이 활성화되었을 때 사용되는 전용 페이지입니다.
      메인 애플리케이션에서 보이지 않는 <iframe>으로 로드됩니다.

      동작 방식:
      1. 메인 앱에서 Keycloak 초기화 시 'check-sso' 옵션이 설정되어 있으면, Keycloak 라이브러리는 이 페이지를 가리키는 숨겨진 <iframe>을 생성합니다.
      2. 이 <iframe>은 Keycloak 서버로 리디렉션되어 현재 브라우저에 유효한 사용자 세션(쿠키 기반)이 있는지 확인합니다.
      3. 확인이 끝나면 Keycloak 서버는 다시 이 페이지로 리디렉션하며, URL에 인증 상태 관련 정보를 포함하여 전달합니다.
      4. 아래의 스크립트는 <iframe> 내부에서 실행되어, 부모 창(메인 애플리케이션)으로 현재 URL(인증 정보 포함)을 메시지로 보냅니다.
      5. 메인 애플리케이션의 Keycloak 인스턴스는 이 메시지를 수신하여, 사용자가 로그인된 상태인지 아닌지를 판단하고 초기화 절차를 완료합니다.

      이러한 과정을 통해, 페이지를 새로고침해도 사용자가 다시 로그인할 필요 없이 기존 세션을 자동으로 유지할 수 있습니다.
    -->
    <script>
      // Keycloak-js 라이브러리가 silent-check-sso iframe과 통신할 수 있도록 합니다.
      // 이 스크립트는 부모 창에 현재 URL을 전달하여 인증 상태 확인을 완료합니다.
      if (parent !== window) {
        parent.postMessage(location.href, location.origin);
      }
    </script>
  </body>
</html>
